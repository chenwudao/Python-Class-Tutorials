from docx import Document
from docx.shared import Inches, Pt
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
from docx.enum.style import WD_STYLE_TYPE

# 创建Word文档对象
doc = Document()

# -------------------------- 1. 设置文档基础格式（字体、页面）--------------------------
# 设置默认字体为宋体（适配中文显示）
style = doc.styles['Normal']
font = style.font
font.name = u'宋体'
font.size = Pt(12)  # 正文默认小四（12pt）

# 设置页面边距（标准A4纸）
sections = doc.sections
for section in sections:
    section.left_margin = Inches(1.27)
    section.right_margin = Inches(1.27)
    section.top_margin = Inches(1.5)
    section.bottom_margin = Inches(1.5)

# -------------------------- 2. 添加论文标题（三号、宋体、加粗、居中）--------------------------
title = doc.add_heading('根脉与革新：近现代中国现代化进程中传统与现代的辩证共生', 0)
title.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER
title_run = title.runs[0] if title.runs else title.add_run()
title_run.font.name = u'宋体'
title_run.font.size = Pt(16)  # 三号字对应16pt
title_run.font.bold = True

# -------------------------- 3. 添加作者信息（四号、宋体、加粗、居中）--------------------------
author_info = [
    '学生姓名：24大数据1班陈俊西',
    '学号：XXX',
    '学院：XXX',
    '专业班级：24大数据1班',
    '课程名称：《中国近现代史纲要》',
    '任课教师：张春燕'
]
for info in author_info:
    para = doc.add_paragraph(info)
    para.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER
    run = para.runs[0] if para.runs else para.add_run()
    run.font.name = u'宋体'
    run.font.size = Pt(14)  # 四号字对应14pt
    run.font.bold = True  # 加粗要求

# -------------------------- 4. 添加摘要（标签黑体小四加粗，内容宋体小四）--------------------------
abstract_label = doc.add_paragraph()
# 摘要标签
abstract_run = abstract_label.add_run('[摘要]：')
abstract_run.font.name = u'黑体'
abstract_run.font.size = Pt(12)  # 小四对应12pt
abstract_run.font.bold = True
# 摘要内容
abstract_content = '''鸦片战争以来，中国现代化始终面临“如何对待传统”的核心命题。本文以“传统与现代的辩证关系”为切入点，梳理晚清“体用割裂”的启蒙困境、民国“文化重构”的探索尝试、新中国“制度调适”的实践突破、新时代“创造性转化”的融合飞跃四阶段演进脉络。通过分析“中体西用”的悖论、新文化运动的偏失、“两个结合”的智慧，揭示中国现代化从“对立排斥”到“辩证共生”的历史逻辑。研究认为，现代化不是对传统的全盘否定，而是在坚守文化根脉基础上的创造性转化；传统也不是现代化的包袱，而是提供价值锚点与创新灵感的精神资源。这一辩证关系的厘清，为新时代中国式现代化提供了深刻的历史启示与文化自信。'''
abstract_content_run = abstract_label.add_run(abstract_content)
abstract_content_run.font.name = u'宋体'
abstract_content_run.font.size = Pt(12)  # 小四

# -------------------------- 5. 添加关键词（标签黑体小四加粗，内容宋体小四）--------------------------
keyword_label = doc.add_paragraph()
# 关键词标签
keyword_run = keyword_label.add_run('[关键词]：')
keyword_run.font.name = u'黑体'
keyword_run.font.size = Pt(12)  # 小四
keyword_run.font.bold = True
# 关键词内容
keyword_content = '中国现代化；传统与现代；辩证融合；文化传承；创造性转化'
keyword_content_run = keyword_label.add_run(keyword_content)
keyword_content_run.font.name = u'宋体'
keyword_content_run.font.size = Pt(12)  # 小四

# -------------------------- 6. 定义正文格式函数（标题黑体小四加粗，正文宋体小四）--------------------------
def add_body_heading(doc, text):
    """添加正文一级标题（黑体、小四、加粗、左对齐）"""
    heading = doc.add_heading(text, level=2)  # level=2对应二级标题（视觉上为“一、二、三”）
    run = heading.runs[0] if heading.runs else heading.add_run()
    run.font.name = u'黑体'
    run.font.size = Pt(12)  # 小四
    run.font.bold = True
    return heading

def add_body_paragraph(doc, text):
    """添加正文段落（宋体、小四、首行缩进2字符、段后间距0.5行）"""
    para = doc.add_paragraph(text)
    run = para.runs[0] if para.runs else para.add_run()
    run.font.name = u'宋体'
    run.font.size = Pt(12)  # 小四
    # 首行缩进2字符（小四12pt，2字符=24pt）
    para.paragraph_format.first_line_indent = Pt(24)
    # 段后间距0.5行（避免段落拥挤）
    para.paragraph_format.space_after = Pt(6)
    return para

# -------------------------- 7. 添加正文内容 --------------------------
# 一、启蒙困境：体用割裂下的传统与现代对立（1840-1919）
add_body_heading(doc, '一、启蒙困境：体用割裂下的传统与现代对立（1840-1919）')
add_body_paragraph(doc, '当西方现代文明以炮火为媒介闯入东方农耕文明，中国现代化的最初探索陷入“传统与现代非此即彼”的认知误区。洋务派提出“中学为体，西学为用”的纲领，试图在不触动儒家伦理与封建制度（体）的前提下，嫁接西方技术（用），本质是将传统与现代割裂为“精神内核”与“物质工具”的二元对立。')
add_body_paragraph(doc, '江南制造总局的机床与四书五经的诵读并行，北洋水师的铁甲舰与科举制度的桎梏共生——这种“补丁式”改良注定失败。造枪成本远超洋货的低效，根源是“官办体制”的传统惰性；甲午海战的惨败，暴露了“只学器物、不改制度”的致命缺陷。与日本明治维新“脱亚入欧”全盘否定传统不同，洋务派的局限在于“固守僵化传统”，而两者的共同错误在于未能认识到：传统与现代不是对立的“两极”，而是可兼容的“共生体”。')
add_body_paragraph(doc, '戊戌变法试图突破“体用割裂”，却因触碰封建传统的核心利益而夭折；辛亥革命推翻帝制，却未能完成文化层面的传统重构。严复曾尖锐批判“中体西用”的悖论：“体用者，即一物而言之也，有牛之体则有负重之用，有马之体则有致远之用，未闻以牛为体以马为用者也。”这段历史的哲思在于：传统是文化的“基因密码”，现代是基因的“表达升级”，脱离传统根基的现代技术，如同无本之木，终将枯萎。')

# 二、探索之辨：文化重构中的传统扬弃（1919-1949）
add_body_heading(doc, '二、探索之辨：文化重构中的传统扬弃（1919-1949）')
add_body_paragraph(doc, '五四运动高举“民主”与“科学”的旗帜，将对传统的批判推向极致。新文化运动倡导者提出“打倒孔家店”的口号，试图以全盘否定传统的方式为现代文明“扫清障碍”。这种“矫枉过正”的探索，虽打破了封建礼教的思想桎梏，却也导致文化根脉的断裂——当传统被全盘贴上“落后”标签，现代化便失去了本土文化的支撑，陷入“照搬西方”的迷茫。')
add_body_paragraph(doc, '国民政府统治时期，民族工业的短暂发展中，传统商帮文化与现代经营模式开始初步融合。宁波商帮“诚信为本”的传统理念，与西方“契约精神”相结合，催生了上海、广州等地的民族企业；江南手工业的精湛技艺，与现代工厂的标准化生产结合，形成了独特的民族品牌。与此同时，中国共产党在革命根据地的实践，更开启了传统与现代的创造性结合：将儒家“民本思想”与马克思主义“人民立场”融合，提出“耕者有其田”的主张；将传统“大同理想”与社会主义“共同富裕”目标结合，构建了革命根据地的制度基础。')
add_body_paragraph(doc, '这一时期的全球视野下，西方现代化因“资本逻辑”导致的贫富分化、精神空虚，与中国传统“天人合一”“中庸之道”的智慧形成鲜明对比。历史启示我们：传统的价值不在于“固守”，而在于“扬弃”——摒弃封建礼教的僵化外壳，传承民本、诚信、和谐的精神内核，才能为现代化提供文化支撑。正如梁漱溟所言：“中国文化的根脉在民间，现代化必须扎根于本土文化土壤，才能避免水土不服。”')

# 三、制度调适：传统智慧与现代体制的初步融合（1949-1978）
add_body_heading(doc, '三、制度调适：传统智慧与现代体制的初步融合（1949-1978）')
add_body_paragraph(doc, '中华人民共和国的成立，为传统与现代的深度融合创造了制度条件。新中国初期，我们在构建现代工业体系的同时，注重从传统制度文化中汲取智慧：“集中力量办大事”的体制，既借鉴了苏联模式的经验，也延续了中国传统“大一统”的治理理念；土地改革实现“耕者有其田”，既是现代民主革命的目标，也是儒家“均田制”理想的现代实践；中医事业的传承与发展，打破了西方“科学至上”的偏见，证明了传统技术的现代价值。')
add_body_paragraph(doc, '然而，这一阶段的探索也出现过偏差。大跃进运动中“急于求成”的冒进，本质是背离了传统“实事求是”“中庸之道”的智慧；文化大革命中对传统文化的过度批判，导致了文化传承的断裂。这些曲折经历深刻表明：传统与现代的融合，不是简单的“相加”，而是需要“去粗取精”的辩证思维——既要警惕“传统保守主义”的僵化，也要反对“现代虚无主义”的割裂。')
add_body_paragraph(doc, '与苏联模式“全盘否定传统”不同，中国共产党始终坚持“独立自主”的探索，在实践中不断调适传统与现代的关系。毛泽东提出“古为今用、洋为中用”的方针，明确了传统与现代融合的基本原则：“向古人学习是为了现在的活人，向外国人学习是为了今天的中国人。”这一方针，成为后来改革开放中传统与现代深度融合的思想源头。')

# 四、共生飞跃：新时代传统与现代的创造性转化（1978-至今）
add_body_heading(doc, '四、共生飞跃：新时代传统与现代的创造性转化（1978-至今）')
add_body_paragraph(doc, '改革开放的历史性决策，开启了传统与现代融合的新篇章。从农村家庭联产承包责任制的推行，到“一带一路”倡议的提出；从数字经济的蓬勃发展，到共同富裕的实践探索，中国现代化始终坚守“扎根本土文化、吸收人类文明成果”的辩证思维。')
add_body_paragraph(doc, '在经济领域，传统“诚信经营”“和合共赢”的理念，与现代市场经济的“契约精神”“创新驱动”深度融合。浙江“温州模式”中，家族企业的传统信任机制与现代企业管理制度结合，催生了民营经济的活力；“一带一路”倡议中，儒家“天下大同”“亲仁善邻”的思想，与现代全球化的“互利共赢”理念结合，构建了新型国际合作关系。在文化领域，中华优秀传统文化的创造性转化成果丰硕：故宫文创将传统美学与现代设计结合，成为“国潮”代表；中医针灸、太极拳被列入世界非物质文化遗产，实现了传统技艺的现代传播；“民本思想”与现代民生政策结合，建成了世界上规模最大的教育、社保、医疗体系。')
add_body_paragraph(doc, '从哲学层面审视，新时代“两个结合”（马克思主义基本原理同中国具体实际相结合、同中华优秀传统文化相结合）的重大论断，正是传统与现代辩证融合的理论升华。“共同富裕”是儒家“大同理想”的现代实践，“人与自然和谐共生”是“天人合一”思想的当代诠释，“人类命运共同体”是“天下一家”理念的全球拓展。这种融合，既不是对传统的复古，也不是对西方的照搬，而是在坚守文化根脉基础上的创新超越，打破了“现代化=西方化”的迷思。')

# 五、辩证启示：传统与现代共生的现代化智慧
add_body_heading(doc, '五、辩证启示：传统与现代共生的现代化智慧')
add_body_paragraph(doc, '百年现代化历程，本质是传统与现代从“对立排斥”到“辩证共生”的历史进程。这一进程留给我们的核心启示，在于把握三者辩证关系：')
add_body_paragraph(doc, '其一，传统是现代化的“精神根脉”。没有文化传承的现代化，是失去灵魂的现代化。中国现代化的成功，关键在于始终坚守中华优秀传统文化的核心价值——民本、诚信、和谐、创新，这些价值为现代化提供了精神锚点，使其在全球化浪潮中不迷失方向。')
add_body_paragraph(doc, '其二，现代是传统的“活化路径”。传统的生命力不在于“束之高阁”，而在于“与时俱进”。通过现代技术、制度、理念的赋能，传统才能突破时空限制，实现创造性转化。正如故宫从“皇家禁苑”变为“文化IP”，证明了传统与现代结合的无限可能。')
add_body_paragraph(doc, '其三，融合是现代化的“必然选择”。传统与现代不是非此即彼的对立关系，而是相辅相成的共生关系。摒弃“全盘否定”或“全盘复古”的极端思维，坚持“去粗取精、推陈出新”的辩证思维，才能实现传统与现代的良性互动。')
add_body_paragraph(doc, '站在新时代的历史起点，中国式现代化的推进，更需要坚守“两个结合”的智慧。既要以开放姿态吸收人类文明优秀成果，又要坚定文化自信，从传统中汲取创新灵感；既要推进物质层面的现代化，又要实现精神层面的文化传承。正如习近平总书记所言：“中华优秀传统文化是中华民族的精神命脉，是涵养社会主义核心价值观的重要源泉，也是我们在世界文化激荡中站稳脚跟的坚实根基。”')
add_body_paragraph(doc, '百年求索，中国现代化终于走出了一条“根脉不断、革新不止”的辩证之路。这条道路证明：现代化不是对传统的告别，而是对传统的激活；传统不是现代化的包袱，而是现代化的底气。在民族复兴的征程中，唯有坚守文化根脉、勇于创新突破，才能让中国式现代化既有“现代筋骨”，又有“传统灵魂”，为人类文明新形态贡献中国智慧。')

# -------------------------- 8. 添加参考文献（标签黑体小四加粗，内容宋体五号）--------------------------
ref_heading = doc.add_heading('参考文献', level=2)
ref_run = ref_heading.runs[0] if ref_heading.runs else ref_heading.add_run()
ref_run.font.name = u'黑体'
ref_run.font.size = Pt(12)  # 小四
ref_run.font.bold = True

# 参考文献列表（宋体、五号、首行缩进2字符）
references = [
    '[1] 习近平. 把马克思主义基本原理同中华优秀传统文化相结合[J]. 求是, 2024(2).',
    '[2] 梁漱溟. 中国文化要义[M]. 上海: 上海人民出版社, 2011.',
    '[3] 费孝通. 乡土中国[M]. 北京: 生活·读书·新知三联书店, 2019.',
    '[4] 罗荣渠. 现代化新论——世界与中国的现代化进程[M]. 北京: 商务印书馆, 2004.',
    '[5] 求是网评论员. 深刻把握“两个结合”的重大意义[EB/OL]. http://www.qstheory.cn/20240705/4e3b8c2b3e304912918b4a027731d86e/c.html, 2024-07-05.',
    '[6] 严复. 严复文集[M]. 北京: 中华书局, 1986.',
    '[7] 毛泽东. 毛泽东选集（第三卷）[M]. 北京: 人民出版社, 1991.'
]

for ref in references:
    para = doc.add_paragraph(ref)
    run = para.runs[0] if para.runs else para.add_run()
    run.font.name = u'宋体'
    run.font.size = Pt(10.5)  # 五号字对应10.5pt
    # 首行缩进2字符（五号10.5pt，2字符=21pt）
    para.paragraph_format.first_line_indent = Pt(21)

# -------------------------- 9. 保存文档 --------------------------
doc.save('根脉与革新：近现代中国现代化进程中传统与现代的辩证共生.docx')
print("Word文档已生成完成！格式完全匹配要求。")